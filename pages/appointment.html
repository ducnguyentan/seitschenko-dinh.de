<!DOCTYPE html>
<!--
  Online Appointment Booking - Termine online buchen
  ========================================================
  Book your dental appointment online with ease.
-->
<html lang="de" id="html-root">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title id="page-title">Termin buchen - Seitschenko-Dinh</title>
  <meta name="description" content="Buchen Sie Ihren Zahnarzttermin online bei Seitschenko-Dinh" id="page-description">
  <link href="../css/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
  <style>
    .appointment-step {
      transition: all 0.3s ease;
    }
    .appointment-step.active {
      border-color: #14b8a6;
      background: #f0fdfa;
    }
    /* Enhanced 3D Time Slot Effects */
    .time-slot {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      position: relative;
      transform-style: preserve-3d;
      background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
      border: 2px solid transparent;
      filter: grayscale(0%) blur(0px) brightness(100%) saturate(100%);
      opacity: 1;
      box-shadow: 0 4px 12px rgba(20, 184, 166, 0.2);
    }

    .time-slot:hover:not(.selected) {
      transform: translateY(-4px) scale(1.05);
      box-shadow: 0 8px 20px rgba(20, 184, 166, 0.35),
                  0 4px 10px rgba(20, 184, 166, 0.25);
      filter: brightness(110%);
    }

    /* Selected time slot - 3D pop-out effect */
    .time-slot.selected {
      background: linear-gradient(135deg, #0d9488 0%, #0f766e 100%);
      color: white;
      font-weight: 700;
      transform: translateY(-8px) scale(1.12) translateZ(20px);
      box-shadow: 0 16px 32px rgba(13, 148, 136, 0.5),
                  0 8px 16px rgba(13, 148, 136, 0.4),
                  0 0 0 3px rgba(13, 148, 136, 0.3),
                  inset 0 2px 8px rgba(255, 255, 255, 0.3);
      z-index: 10;
      border-color: #0f766e;
      animation: time-slot-pulse 2s ease-in-out infinite;
    }

    /* Dimmed time slots when one is selected */
    .time-slot.dimmed {
      filter: grayscale(50%) blur(1px) brightness(75%) saturate(50%);
      opacity: 0.4;
      transform: scale(0.95);
      box-shadow: 0 2px 6px rgba(20, 184, 166, 0.1);
    }

    /* Booked time slot - disabled style */
    .time-slot.booked {
      background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%) !important;
      color: #6b7280 !important;
      cursor: not-allowed !important;
      opacity: 0.6;
      box-shadow: 0 2px 6px rgba(107, 114, 128, 0.15);
      position: relative;
    }

    .time-slot.booked:hover {
      transform: none !important;
      filter: none !important;
    }

    .time-slot.booked::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 10%;
      right: 10%;
      height: 2px;
      background: #9ca3af;
      transform: translateY(-50%);
    }

    @keyframes time-slot-pulse {
      0%, 100% {
        box-shadow: 0 16px 32px rgba(13, 148, 136, 0.5),
                    0 8px 16px rgba(13, 148, 136, 0.4),
                    0 0 0 3px rgba(13, 148, 136, 0.3),
                    inset 0 2px 8px rgba(255, 255, 255, 0.3);
      }
      50% {
        box-shadow: 0 18px 36px rgba(13, 148, 136, 0.6),
                    0 10px 20px rgba(13, 148, 136, 0.5),
                    0 0 0 4px rgba(13, 148, 136, 0.4),
                    inset 0 3px 10px rgba(255, 255, 255, 0.4);
      }
    }

    .time-slot .badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(239, 68, 68, 0.4);
      animation: badge-pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.5);
    }

    @keyframes badge-pop {
      0% {
        transform: scale(0);
        opacity: 0;
      }
      50% {
        transform: scale(1.2);
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    /* Enhanced 3D Symptom Card Effects */
    .symptom-card {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      border: 2px solid #e5e7eb;
      position: relative;
      transform-style: preserve-3d;
      filter: grayscale(0%) blur(0px) brightness(100%);
      opacity: 1;
    }

    .symptom-card:hover:not(.selected) {
      border-color: #14b8a6;
      transform: translateY(-6px) scale(1.02);
      box-shadow: 0 12px 28px rgba(20, 184, 166, 0.25),
                  0 6px 12px rgba(20, 184, 166, 0.15);
    }

    /* Selected card - 3D pop-out effect */
    .symptom-card.selected {
      border-color: #14b8a6;
      background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%);
      transform: translateY(-12px) scale(1.08) translateZ(30px);
      box-shadow: 0 20px 40px rgba(20, 184, 166, 0.4),
                  0 10px 20px rgba(20, 184, 166, 0.3),
                  0 0 0 3px rgba(20, 184, 166, 0.2),
                  inset 0 2px 8px rgba(255, 255, 255, 0.8);
      z-index: 10;
      filter: grayscale(0%) blur(0px) brightness(110%);
      animation: pulse-glow 2s ease-in-out infinite;
    }

    /* Blur and fade other cards when one is selected */
    .symptom-card.dimmed {
      filter: grayscale(40%) blur(1.5px) brightness(85%);
      opacity: 0.5;
      transform: scale(0.95);
      box-shadow: none;
    }

    @keyframes pulse-glow {
      0%, 100% {
        box-shadow: 0 20px 40px rgba(20, 184, 166, 0.4),
                    0 10px 20px rgba(20, 184, 166, 0.3),
                    0 0 0 3px rgba(20, 184, 166, 0.2),
                    inset 0 2px 8px rgba(255, 255, 255, 0.8);
      }
      50% {
        box-shadow: 0 22px 45px rgba(20, 184, 166, 0.5),
                    0 12px 24px rgba(20, 184, 166, 0.4),
                    0 0 0 4px rgba(20, 184, 166, 0.3),
                    inset 0 3px 10px rgba(255, 255, 255, 0.9);
      }
    }

    .symptom-card .checkmark {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      color: white;
      box-shadow: 0 4px 12px rgba(20, 184, 166, 0.5);
      animation: checkmark-pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.5);
    }

    .symptom-card.selected .checkmark {
      display: flex;
    }

    @keyframes checkmark-pop {
      0% {
        transform: scale(0) rotate(-180deg);
        opacity: 0;
      }
      50% {
        transform: scale(1.2) rotate(10deg);
      }
      100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }
    }

    /* Icon container 3D effect */
    .symptom-card .icon-container {
      transition: transform 0.3s ease;
    }

    .symptom-card.selected .icon-container {
      transform: scale(1.15) translateZ(10px);
    }
    .doctor-card {
      transition: all 0.3s ease;
      cursor: pointer;
      border: 2px solid #e5e7eb;
    }
    .doctor-card:hover {
      border-color: #14b8a6;
      box-shadow: 0 8px 20px rgba(20, 184, 166, 0.2);
    }
    .doctor-card.selected {
      border-color: #14b8a6;
      background: #f0fdfa;
    }
    .location-tab {
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
    }
    .location-tab:hover {
      border-bottom-color: #14b8a6;
    }
    .location-tab.active {
      border-bottom-color: #14b8a6;
      color: #14b8a6;
      font-weight: 600;
    }

    /* ===== RESPONSIVE DESIGN ===== */

    /* Mobile First: Base styles for phones (320px - 640px) */
    @media (max-width: 640px) {
      /* Hero section */
      .hero-bg-appointment {
        padding-top: 80px;
        padding-bottom: 2rem;
        background-attachment: scroll !important; /* Better performance on mobile */
      }

      .hero-bg-appointment h1 {
        font-size: 1.75rem !important;
        line-height: 2rem !important;
      }

      .hero-bg-appointment p {
        font-size: 1rem !important;
      }

      /* Symptom cards - Stack vertically on mobile with better touch targets */
      .symptom-card {
        padding: 1rem !important;
        min-height: 120px; /* Better touch target */
      }

      .symptom-card h3 {
        font-size: 0.875rem !important;
      }

      .symptom-card p {
        font-size: 0.75rem !important;
      }

      /* Disable hover effects on mobile, use active state instead */
      .symptom-card:hover:not(.selected) {
        transform: none;
      }

      .symptom-card:active:not(.selected) {
        transform: scale(0.98);
        transition: transform 0.1s;
      }

      /* Time slots - 2 columns on mobile with better touch */
      #time-slots-container .grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.75rem !important;
      }

      .time-slot {
        padding: 1rem 0.5rem !important;
        font-size: 0.875rem !important;
        min-height: 50px; /* Minimum touch target 48px */
      }

      /* Disable hover on mobile, use active */
      .time-slot:hover:not(.selected) {
        transform: none;
      }

      .time-slot:active:not(.selected) {
        transform: scale(0.95);
      }

      /* Booking summary */
      .booking-summary {
        padding: 1rem !important;
      }

      /* Doctor dropdown - Full width on mobile */
      #doctor-selector-btn {
        width: 100% !important;
      }

      .doctor-dropdown-menu {
        max-height: 60vh !important;
        left: 0 !important;
        right: 0 !important;
        width: 100% !important;
      }

      /* Reduce spacing */
      .appointment-step {
        padding: 1rem !important;
        margin-bottom: 1rem !important;
      }

      /* Custom description textarea */
      #custom-description {
        font-size: 0.875rem !important;
        min-height: 100px;
      }

      /* Navigation buttons - Larger touch targets */
      button {
        min-height: 44px;
        min-width: 44px;
      }

      /* Confirm button - Enhanced animations */
      #confirm-button {
        font-size: 1rem !important;
        padding: 1rem !important;
        position: relative;
        overflow: hidden;
        background-size: 200% 100%;
        animation: gradient-shift 3s ease infinite;
      }

      @keyframes gradient-shift {
        0%, 100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }

      @keyframes button-pulse {
        0%, 100% {
          box-shadow: 0 0 0 0 rgba(20, 184, 166, 0.7);
        }
        50% {
          box-shadow: 0 0 0 15px rgba(20, 184, 166, 0);
        }
      }

      @keyframes send-icon-fly {
        0% {
          transform: translate(0, 0) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translate(100px, -100px) rotate(45deg);
          opacity: 0;
        }
      }

      @keyframes success-checkmark {
        0% {
          transform: scale(0) rotate(0deg);
          opacity: 0;
        }
        50% {
          transform: scale(1.2) rotate(180deg);
        }
        100% {
          transform: scale(1) rotate(360deg);
          opacity: 1;
        }
      }

      #confirm-button:not(:disabled):hover {
        animation: button-pulse 1.5s infinite, gradient-shift 3s ease infinite;
      }

      #confirm-button.sending {
        background: linear-gradient(90deg, #0891b2, #06b6d4, #0891b2, #06b6d4);
        background-size: 300% 100%;
        animation: gradient-wave 1.5s linear infinite;
        box-shadow: 0 0 20px rgba(20, 184, 166, 0.5);
      }

      @keyframes gradient-wave {
        0% {
          background-position: 0% 50%;
        }
        100% {
          background-position: 100% 50%;
        }
      }

      #confirm-button.success {
        background: linear-gradient(135deg, #10b981, #059669);
        animation: success-bounce 0.6s ease-out;
        box-shadow: 0 0 30px rgba(16, 185, 129, 0.6);
      }

      @keyframes success-bounce {
        0%, 100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      #confirm-button.error {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        animation: error-shake 0.5s ease-out;
        box-shadow: 0 0 30px rgba(239, 68, 68, 0.6);
      }

      @keyframes error-shake {
        0%, 100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }

      .icon-fly {
        animation: send-icon-fly 0.6s ease-out forwards;
      }

      .icon-success {
        animation: success-checkmark 0.6s ease-out forwards;
      }

      /* Mobile menu improvements */
      #mobile-menu {
        max-height: calc(100vh - 80px);
        overflow-y: auto;
      }

      /* Notice banner - Better mobile layout */
      .bg-blue-600 {
        flex-direction: column !important;
        text-align: center;
      }
    }

    /* Tablets - Portrait (641px - 768px) */
    @media (min-width: 641px) and (max-width: 768px) {
      .hero-bg-appointment h1 {
        font-size: 2.25rem !important;
      }

      /* Symptom cards - 2 columns */
      .symptom-card {
        padding: 1.25rem !important;
      }

      /* Time slots - 3 columns */
      #time-slots-container .grid {
        grid-template-columns: repeat(3, 1fr) !important;
      }
    }

    /* Tablets - Landscape & Small Laptops (769px - 1024px) */
    @media (min-width: 769px) and (max-width: 1024px) {
      .hero-bg-appointment {
        padding-top: 90px;
      }

      /* Symptom cards - 2 columns */
      .symptom-card {
        padding: 1.5rem !important;
      }

      /* Time slots - 4 columns */
      #time-slots-container .grid {
        grid-template-columns: repeat(4, 1fr) !important;
      }

      /* Container max width */
      .container {
        max-width: 900px !important;
      }
    }

    /* Desktop & Large Screens (1025px+) */
    @media (min-width: 1025px) {
      /* Optimal spacing for large screens */
      .appointment-step {
        padding: 2rem !important;
      }

      /* Time slots - 6 columns (original) */
      #time-slots-container .grid {
        grid-template-columns: repeat(6, 1fr) !important;
      }

      /* Container max width */
      .container {
        max-width: 1200px !important;
      }

      /* Better hover effects on desktop */
      .symptom-card:hover:not(.selected) {
        transform: translateY(-8px) scale(1.03);
      }

      .time-slot:hover:not(.selected) {
        transform: translateY(-6px) scale(1.08);
      }
    }

    /* Extra Large Screens (1440px+) */
    @media (min-width: 1440px) {
      .container {
        max-width: 1400px !important;
      }

      .hero-bg-appointment h1 {
        font-size: 3.5rem !important;
      }
    }

    /* Landscape orientation specific fixes */
    @media (orientation: landscape) and (max-height: 600px) {
      .hero-bg-appointment {
        padding-top: 60px;
        padding-bottom: 1rem;
      }

      .appointment-step {
        margin-bottom: 1rem !important;
      }
    }

    /* Print styles */
    @media print {
      .hero-bg-appointment {
        background: white !important;
        color: black !important;
      }

      .time-slot, .symptom-card {
        box-shadow: none !important;
        border: 1px solid #ccc !important;
      }

      header, footer, button {
        display: none !important;
      }
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow-lg fixed top-0 left-0 right-0 z-50">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between py-4">
        <!-- Logo -->
        <div class="flex items-center space-x-3">
          <img src="../assets/img/logo.svg" alt="Seitschenko-Dinh Logo" class="w-12 h-12">
          <a href="../index.html" class="flex flex-col leading-tight">
            <span class="text-sm font-bold text-gray-800 tracking-wide" data-translate="header.practice_name1">ZAHNARZTPRAXEN</span>
            <span class="text-sm font-bold text-gray-800 tracking-wide" data-translate="header.practice_name2">SEITSCHENKO-DINH</span>
          </a>
        </div>

        <!-- Navigation and Language Switcher -->
        <div class="hidden md:flex items-center space-x-4">
          <nav class="flex space-x-2">
            <a href="../index.html#home" class="nav-link" data-translate="nav.home">Start</a>
            <a href="about-us.html" class="nav-link" data-translate="nav.about">√úber uns</a>
            <a href="services.html" class="nav-link" data-translate="nav.services">Leistungen</a>
            <a href="labor.html" class="nav-link" data-translate="nav.labor">Labor</a>
            <a href="karriere.html" class="nav-link" data-translate="nav.karriere">Karriere</a>
            <a href="contact.html" class="nav-link" data-translate="nav.contact">Kontakt</a>
          </nav>

          <!-- Language Switcher -->
          <div class="language-switcher">
            <button id="language-btn" class="flex items-center space-x-1 px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
              <img id="current-flag" src="https://flagcdn.com/24x18/de.png" alt="Deutsch" class="language-flag">
              <span id="current-lang">DE</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div id="language-menu" class="language-menu">
              <a href="#" onclick="changeLanguage('de')" class="language-option" data-lang="de">
                <img src="https://flagcdn.com/24x18/de.png" alt="Deutsch" class="language-flag">
                Deutsch
              </a>
              <a href="#" onclick="changeLanguage('en')" class="language-option" data-lang="en">
                <img src="https://flagcdn.com/24x18/us.png" alt="English" class="language-flag">
                English
              </a>
              <a href="#" onclick="changeLanguage('vi')" class="language-option" data-lang="vi">
                <img src="https://flagcdn.com/24x18/vn.png" alt="Ti·∫øng Vi·ªát" class="language-flag">
                Ti·∫øng Vi·ªát
              </a>
              <a href="#" onclick="changeLanguage('ru')" class="language-option" data-lang="ru">
                <img src="https://flagcdn.com/24x18/ru.png" alt="–†—É—Å—Å–∫–∏–π" class="language-flag">
                –†—É—Å—Å–∫–∏–π
              </a>
              <a href="#" onclick="changeLanguage('ar')" class="language-option" data-lang="ar">
                <img src="https://flagcdn.com/24x18/sa.png" alt="ÿßŸÑÿπÿ±ÿ®Ÿäÿ©" class="language-flag">
                ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
              </a>
            </div>
          </div>
        </div>

        <!-- Mobile Menu Button -->
        <button id="mobile-menu-btn" class="md:hidden p-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>

      <!-- Mobile Menu -->
      <div id="mobile-menu" class="md:hidden hidden pb-4">
        <div class="flex flex-col space-y-2">
          <a href="../index.html#home" class="nav-link" data-translate="nav.home">Start</a>
          <a href="about-us.html" class="nav-link" data-translate="nav.about">√úber uns</a>
          <a href="services.html" class="nav-link" data-translate="nav.services">Leistungen</a>
          <a href="labor.html" class="nav-link" data-translate="nav.labor">Labor</a>
          <a href="karriere.html" class="nav-link" data-translate="nav.karriere">Karriere</a>
          <a href="contact.html" class="nav-link" data-translate="nav.contact">Kontakt</a>

          <!-- Mobile Language Switcher -->
          <div class="pt-2 border-t border-gray-200">
            <div class="language-switcher-mobile">
              <button id="mobile-language-btn" class="flex items-center justify-between w-full px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                <span data-translate="language.current">Sprache:</span>
                <div class="flex items-center space-x-1">
                  <img id="mobile-current-flag" src="https://flagcdn.com/24x18/de.png" alt="Deutsch" class="language-flag">
                  <span id="mobile-current-lang">DE</span>
                </div>
              </button>
              <div id="mobile-language-menu" class="language-menu-mobile">
                <a href="#" onclick="changeLanguage('de')" class="language-option-mobile" data-lang="de">
                  <img src="https://flagcdn.com/24x18/de.png" alt="Deutsch" class="language-flag">
                  Deutsch
                </a>
                <a href="#" onclick="changeLanguage('en')" class="language-option-mobile" data-lang="en">
                  <img src="https://flagcdn.com/24x18/us.png" alt="English" class="language-flag">
                  English
                </a>
                <a href="#" onclick="changeLanguage('vi')" class="language-option-mobile" data-lang="vi">
                  <img src="https://flagcdn.com/24x18/vn.png" alt="Ti·∫øng Vi·ªát" class="language-flag">
                  Ti·∫øng Vi·ªát
                </a>
                <a href="#" onclick="changeLanguage('ru')" class="language-option-mobile" data-lang="ru">
                  <img src="https://flagcdn.com/24x18/ru.png" alt="–†—É—Å—Å–∫–∏–π" class="language-flag">
                  –†—É—Å—Å–∫–∏–π
                </a>
                <a href="#" onclick="changeLanguage('ar')" class="language-option-mobile" data-lang="ar">
                  <img src="https://flagcdn.com/24x18/sa.png" alt="ÿßŸÑÿπÿ±ÿ®Ÿäÿ©" class="language-flag">
                  ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero Section with Background -->
  <section class="hero-bg-appointment py-16 relative overflow-hidden">
    <div class="absolute inset-0 bg-white bg-opacity-40"></div>
    <div class="relative z-10 text-center max-w-4xl mx-auto px-4">
      <h1 class="text-3xl md:text-5xl font-bold mb-4 text-teal-700" data-translate="hero.title">
        Termine online buchen
      </h1>
      <p class="text-lg md:text-xl text-gray-800 font-medium" data-translate="hero.subtitle">
        Zahnarztpraxis Seitschenko-Dinh (Wall 3, 42103 Wuppertal)
      </p>
    </div>
  </section>

  <!-- Main Content -->
  <main class="pb-20 bg-gray-50">
    <div class="container mx-auto px-4 max-w-6xl pt-8">

      <!-- Notice Banner -->
      <div class="bg-blue-600 text-white rounded-xl p-4 mb-8 flex items-start space-x-3">
        <svg class="w-6 h-6 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <div>
          <p class="text-sm opacity-90" data-translate="notice.text">
            Wichtiger Hinweis: Termine bei Frau Vera Seitschenko-Dinh sind nur telefonisch m√∂glich. Bitte rufen Sie uns unter 0202 660828 an.
          </p>
        </div>
        <button class="ml-auto text-white hover:text-gray-200" onclick="this.parentElement.style.display='none'">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <!-- Step 1: Choose Symptom / Reason -->
      <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 mb-6 appointment-step active" id="step-symptoms">
        <h2 class="text-2xl font-bold text-gray-800 mb-6" data-translate="symptoms.title">
          W√§hlen Sie Ihren Grund f√ºr den Besuch
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
          <!-- Symptom 1 -->
          <div class="symptom-card relative rounded-xl p-5" onclick="selectSymptom(this, 'pain')">
            <div class="checkmark">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <div class="flex flex-col items-center text-center">
              <div class="icon-container w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mb-3">
                <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                </svg>
              </div>
              <h3 class="font-semibold text-gray-800 mb-1" data-translate="symptoms.pain.title">Schmerzen und Beschwerden</h3>
              <p class="text-sm text-gray-600" data-translate="symptoms.pain.description">Zahnschmerzen, Empfindlichkeit oder akute Probleme</p>
            </div>
          </div>

          <!-- Symptom 2 -->
          <div class="symptom-card relative rounded-xl p-5" onclick="selectSymptom(this, 'checkup')">
            <div class="checkmark">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <div class="flex flex-col items-center text-center">
              <div class="icon-container w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mb-3">
                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                </svg>
              </div>
              <h3 class="font-semibold text-gray-800 mb-1" data-translate="symptoms.checkup.title">Vorsorgeuntersuchung</h3>
              <p class="text-sm text-gray-600" data-translate="symptoms.checkup.description">Routinekontrolle und Prophylaxe</p>
            </div>
          </div>

          <!-- Symptom 3 -->
          <div class="symptom-card relative rounded-xl p-5" onclick="selectSymptom(this, 'consultation')">
            <div class="checkmark">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <div class="flex flex-col items-center text-center">
              <div class="icon-container w-12 h-12 rounded-full bg-green-100 flex items-center justify-center mb-3">
                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                </svg>
              </div>
              <h3 class="font-semibold text-gray-800 mb-1" data-translate="symptoms.consultation.title">Allgemeine Beratung</h3>
              <p class="text-sm text-gray-600" data-translate="symptoms.consultation.description">Beratung zu Behandlungsm√∂glichkeiten</p>
            </div>
          </div>

          <!-- Symptom 4 -->
          <div class="symptom-card relative rounded-xl p-5" onclick="selectSymptom(this, 'cleaning')">
            <div class="checkmark">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <div class="flex flex-col items-center text-center">
              <div class="icon-container w-12 h-12 rounded-full bg-teal-100 flex items-center justify-center mb-3">
                <svg class="w-6 h-6 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                </svg>
              </div>
              <h3 class="font-semibold text-gray-800 mb-1" data-translate="symptoms.cleaning.title">Professionelle Zahnreinigung</h3>
              <p class="text-sm text-gray-600" data-translate="symptoms.cleaning.description">PZR und Prophylaxe-Behandlung</p>
            </div>
          </div>
        </div>

        <!-- Custom Description -->
        <div class="mt-6 p-4 bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl border border-teal-100">
          <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
            <svg class="w-5 h-5 text-teal-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
            <span data-translate="symptoms.custom_label">Beschreiben Sie Ihr Anliegen genauer:</span>
          </label>
          <textarea
            id="custom-description"
            rows="4"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all resize-none bg-white shadow-sm hover:shadow-md"
            placeholder="z.B. Ich habe seit 3 Tagen starke Zahnschmerzen im rechten Backenzahn..."
            data-translate-placeholder="symptoms.custom_placeholder"
          ></textarea>
          <p class="text-xs text-gray-500 mt-2">
            <span data-translate="symptoms.custom_hint">üí° Tipp: Je genauer Sie Ihr Problem beschreiben, desto besser k√∂nnen wir Sie beraten.</span>
          </p>
        </div>
      </div>

      <!-- Step 2: Choose Doctor -->
      <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 mb-6 appointment-step" id="step-doctor">
        <h2 class="text-2xl font-bold text-gray-800 mb-6" data-translate="doctors.title">
          W√§hlen Sie Ihren Wunsch-Arzt
        </h2>

        <!-- Doctor Selection Dropdown -->
        <div class="mb-8">
          <!-- Doctor Selector Button -->
          <div class="doctor-selector relative">
            <button id="doctor-selector-btn" class="w-full md:w-auto flex items-center justify-between px-4 py-3 bg-white border-2 border-gray-300 rounded-lg hover:border-teal-500 hover:bg-gray-50 transition-all">
              <div class="flex items-center space-x-3">
                <img id="selected-doctor-avatar" src="../assets/img/khonghinh.jpg" alt="Doctor" class="w-14 h-14 rounded-full object-cover" style="object-position: center 15%">
                <div class="text-left">
                  <p id="selected-doctor-name" class="font-semibold text-gray-800" data-translate="doctors.select_placeholder">W√§hlen Sie einen Arzt</p>
                  <p id="selected-doctor-location" class="text-xs text-gray-500"></p>
                </div>
              </div>
              <svg class="w-5 h-5 text-gray-600 ml-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>

            <!-- Dropdown Menu -->
            <div id="doctor-dropdown-menu" class="doctor-dropdown-menu hidden absolute top-full left-0 right-0 md:min-w-96 mt-2 bg-white rounded-lg shadow-xl border-2 border-gray-200 z-50 max-h-80 overflow-y-auto">
              <!-- Doctor Option 1: Seitschenko-Dinh -->
              <div class="doctor-option flex items-center space-x-3 px-4 py-3 hover:bg-teal-50 cursor-pointer transition-colors border-b border-gray-100" onclick="selectDoctorFromDropdown('seitschenko-dinh', 'Zahn√§rztin Frau Seitschenko-Dinh', 'Loher Str. 40, 42283 Wuppertal', '../assets/img/Vera Seitschenko-Dinh.jpg')">
                <img src="../assets/img/Vera Seitschenko-Dinh.jpg" alt="Frau Seitschenko-Dinh" class="w-16 h-16 rounded-full object-cover flex-shrink-0" style="object-position: center 15%">
                <div class="flex-1">
                  <p class="font-semibold text-gray-800" data-translate="doctors.seitschenko.name">Zahn√§rztin Frau Seitschenko-Dinh</p>
                  <p class="text-xs text-teal-600" data-translate="doctors.seitschenko.location">Loher Str. 40, 42283 Wuppertal</p>
                </div>
              </div>

              <!-- Doctor Option 2: Kukadiya -->
              <div class="doctor-option flex items-center space-x-3 px-4 py-3 hover:bg-teal-50 cursor-pointer transition-colors border-b border-gray-100" onclick="selectDoctorFromDropdown('kukadiya', 'Zahn√§rztin Dr. Kukadiya', 'Loher Str. 40, 42283 Wuppertal', '../assets/img/Kukadiya.jpg')">
                <img src="../assets/img/Kukadiya.jpg" alt="Dr. Kukadiya" class="w-16 h-16 rounded-full object-cover flex-shrink-0" style="object-position: center 15%">
                <div class="flex-1">
                  <p class="font-semibold text-gray-800" data-translate="doctors.kukadiya.name">Zahn√§rztin Dr. Kukadiya</p>
                  <p class="text-xs text-teal-600" data-translate="doctors.kukadiya.location">Loher Str. 40, 42283 Wuppertal</p>
                </div>
              </div>

              <!-- Doctor Option 3: Ikikardes -->
              <div class="doctor-option flex items-center space-x-3 px-4 py-3 hover:bg-teal-50 cursor-pointer transition-colors border-b border-gray-100" onclick="selectDoctorFromDropdown('ikikardes', 'Zahnarzt Herr IKIKARDES', 'Schwarzbach 2, 42277 Wuppertal', '../assets/img/ikkardes.jpeg')">
                <img src="../assets/img/ikkardes.jpeg" alt="Herr IKIKARDES" class="w-16 h-16 rounded-full object-cover flex-shrink-0" style="object-position: center 15%">
                <div class="flex-1">
                  <p class="font-semibold text-gray-800" data-translate="doctors.ikikardes.name">Zahnarzt Herr IKIKARDES</p>
                  <p class="text-xs text-teal-600" data-translate="doctors.ikikardes.location">Schwarzbach 2, 42277 Wuppertal</p>
                </div>
              </div>

              <!-- Doctor Option 4: Taifour -->
              <div class="doctor-option flex items-center space-x-3 px-4 py-3 hover:bg-teal-50 cursor-pointer transition-colors border-b border-gray-100" onclick="selectDoctorFromDropdown('taifour', 'Zahnarzt Herr TAIFOUR', 'Schwarzbach 2, 42277 Wuppertal', '../assets/img/taifour.jpeg')">
                <img src="../assets/img/taifour.jpeg" alt="Herr TAIFOUR" class="w-16 h-16 rounded-full object-cover flex-shrink-0" style="object-position: center 15%">
                <div class="flex-1">
                  <p class="font-semibold text-gray-800" data-translate="doctors.taifour.name">Zahnarzt Herr TAIFOUR</p>
                  <p class="text-xs text-teal-600" data-translate="doctors.taifour.location">Schwarzbach 2, 42277 Wuppertal</p>
                </div>
              </div>

              <!-- Doctor Option 5: Nikolaou -->
              <div class="doctor-option flex items-center space-x-3 px-4 py-3 hover:bg-teal-50 cursor-pointer transition-colors" onclick="selectDoctorFromDropdown('nikolaou', 'Zahnarzt Herr NIKOLAOU', 'Loher Str. 40, 42283 Wuppertal', '../assets/img/khonghinh.jpg')">
                <img src="../assets/img/khonghinh.jpg" alt="Herr NIKOLAOU" class="w-16 h-16 rounded-full object-cover flex-shrink-0" style="object-position: center 15%">
                <div class="flex-1">
                  <p class="font-semibold text-gray-800" data-translate="doctors.nikolaou.name">Zahnarzt Herr NIKOLAOU</p>
                  <p class="text-xs text-teal-600" data-translate="doctors.nikolaou.location">Loher Str. 40, 42283 Wuppertal</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Dropdown Menu Styling -->
          <style>
            .doctor-selector {
              position: relative;
            }

            .doctor-dropdown-menu {
              animation: slideDown 0.3s ease-out;
            }

            @keyframes slideDown {
              from {
                opacity: 0;
                transform: translateY(-10px);
              }
              to {
                opacity: 1;
                transform: translateY(0);
              }
            }

            .doctor-dropdown-menu::-webkit-scrollbar {
              width: 8px;
            }

            .doctor-dropdown-menu::-webkit-scrollbar-track {
              background: #f1f1f1;
              border-radius: 10px;
            }

            .doctor-dropdown-menu::-webkit-scrollbar-thumb {
              background: #14b8a6;
              border-radius: 10px;
            }

            .doctor-dropdown-menu::-webkit-scrollbar-thumb:hover {
              background: #0d9488;
            }

            .doctor-option:last-child {
              border-bottom: none;
            }

            #doctor-selector-btn {
              box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            }

            #doctor-selector-btn:hover {
              box-shadow: 0 4px 6px rgba(20, 184, 166, 0.1);
            }
          </style>
        </div>

        <!-- Calendar & Time Slots (Hidden until doctor is selected) -->
        <div id="appointment-calendar" class="hidden">
          <h3 class="text-lg font-semibold text-gray-800 mb-4" data-translate="calendar.title">
            W√§hlen Sie Datum und Uhrzeit
          </h3>

          <!-- Date Navigation -->
          <div class="flex items-center justify-between mb-6 pb-4 border-b border-gray-200">
            <button class="p-2 hover:bg-gray-100 rounded-lg transition-colors" onclick="previousWeek()">
              <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
            </button>
            <div class="text-center">
              <p class="text-sm text-gray-600" data-translate="calendar.week">Woche vom</p>
              <p class="text-lg font-semibold text-gray-800" id="current-week">Laden...</p>
            </div>
            <button class="p-2 hover:bg-gray-100 rounded-lg transition-colors" onclick="nextWeek()">
              <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </button>
          </div>

          <!-- Time Slots by Day (Dynamic) -->
          <div class="space-y-6" id="time-slots-container">
            <!-- Will be populated by JavaScript -->
          </div>

          <!-- Load More Button -->
          <div class="text-center mt-8">
            <button class="inline-flex items-center px-6 py-3 border-2 border-teal-600 text-teal-600 font-semibold rounded-full hover:bg-teal-50 transition-all" onclick="loadMoreDates()">
              <span data-translate="calendar.load_more">Weitere Termine</span>
              <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Booking Summary & Confirm -->
      <div class="bg-gradient-to-br from-teal-50 to-cyan-50 rounded-2xl shadow-lg p-6 md:p-8" id="booking-summary">
        <h3 class="text-xl font-bold text-gray-800 mb-4" data-translate="summary.title">
          Zusammenfassung Ihrer Buchung
        </h3>

        <div class="space-y-3 mb-6">
          <div class="flex items-center space-x-3">
            <svg class="w-5 h-5 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            <div class="flex-1">
              <p class="text-sm text-gray-600" data-translate="summary.symptom">Grund:</p>
              <p class="font-semibold text-gray-800" id="selected-symptom-text">-</p>
              <div class="mt-2 p-2 bg-teal-50 rounded-lg border border-teal-200" id="custom-description-text" style="display: none;">
                <p class="text-xs text-gray-500 mb-1" data-translate="summary.description_label">üìù Ihre Beschreibung:</p>
                <p class="text-sm text-gray-700 italic" id="custom-description-content"></p>
              </div>
            </div>
          </div>

          <div class="flex items-center space-x-3">
            <svg class="w-5 h-5 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
            <div>
              <p class="text-sm text-gray-600" data-translate="summary.doctor">Arzt:</p>
              <p class="font-semibold text-gray-800" id="selected-doctor-text">-</p>
            </div>
          </div>

          <div class="flex items-center space-x-3">
            <svg class="w-5 h-5 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
            <div>
              <p class="text-sm text-gray-600" data-translate="summary.datetime">Termin:</p>
              <p class="font-semibold text-gray-800" id="selected-time-text">-</p>
            </div>
          </div>
        </div>

        <!-- Patient Information Form -->
        <div class="pt-4 mt-4 border-t border-teal-200">
          <h4 class="text-lg font-semibold text-gray-800 mb-4" data-translate="summary.patient_info_title">
            Ihre Kontaktdaten
          </h4>

          <div class="space-y-4">
            <!-- First Name -->
            <div>
              <label for="patient-firstname" class="block text-sm font-medium text-gray-700 mb-1" data-translate="summary.patient_firstname">
                Vorname *
              </label>
              <input
                type="text"
                id="patient-firstname"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors"
                placeholder="z.B. Max"
                data-translate-placeholder="summary.patient_firstname_placeholder"
                required
              />
            </div>

            <!-- Last Name -->
            <div>
              <label for="patient-lastname" class="block text-sm font-medium text-gray-700 mb-1" data-translate="summary.patient_lastname">
                Nachname *
              </label>
              <input
                type="text"
                id="patient-lastname"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors"
                placeholder="z.B. Mustermann"
                data-translate-placeholder="summary.patient_lastname_placeholder"
                required
              />
            </div>

            <!-- Birth Year -->
            <div>
              <label for="patient-birth-year" class="block text-sm font-medium text-gray-700 mb-1" data-translate="summary.patient_birth_year">
                Geburtsjahr *
              </label>
              <input
                type="number"
                id="patient-birth-year"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors"
                placeholder="z.B. 1990"
                data-translate-placeholder="summary.patient_birth_year_placeholder"
                min="1900"
                max="2025"
                required
              />
            </div>

            <!-- Phone Number -->
            <div>
              <label for="patient-phone" class="block text-sm font-medium text-gray-700 mb-1" data-translate="summary.patient_phone">
                Telefonnummer *
              </label>
              <input
                type="tel"
                id="patient-phone"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors"
                placeholder="z.B. 0202 660828"
                data-translate-placeholder="summary.patient_phone_placeholder"
                required
              />
            </div>

            <!-- Email -->
            <div>
              <label for="patient-email" class="block text-sm font-medium text-gray-700 mb-1" data-translate="summary.patient_email">
                E-Mail-Adresse *
              </label>
              <input
                type="email"
                id="patient-email"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors"
                placeholder="z.B. max@example.com"
                data-translate-placeholder="summary.patient_email_placeholder"
                required
              />
            </div>

            <!-- Reminder Time -->
            <div>
              <label for="reminder-time" class="block text-sm font-medium text-gray-700 mb-1" data-translate="summary.reminder_time">
                Erinnerung vor dem Termin *
              </label>
              <select
                id="reminder-time"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-colors"
                required
              >
                <option value="0.5">30 Minuten</option>
                <option value="1">1 Stunde</option>
                <option value="2" selected>2 Stunden</option>
                <option value="3">3 Stunden</option>
                <option value="6">6 Stunden</option>
                <option value="12">12 Stunden</option>
                <option value="24">1 Tag</option>
              </select>
              <p class="text-xs text-teal-600 mt-2 italic" data-translate="summary.reminder_note">
                üìß Die Terminerinnerung wird Ihnen per E-Mail zugesendet
              </p>
            </div>

            <p class="text-xs text-gray-500 italic" data-translate="summary.required_fields_note">
              * Pflichtfelder - Wir ben√∂tigen diese Informationen zur Terminbest√§tigung
            </p>
          </div>
        </div>

        <div class="pt-4 border-t border-teal-200 mt-6">
          <button
            id="confirm-button"
            class="w-full bg-gradient-to-r from-teal-500 via-cyan-500 to-teal-600 text-white font-bold py-3 px-5 rounded-xl hover:from-teal-600 hover:via-cyan-600 hover:to-teal-700 transition-all duration-500 transform hover:scale-105 hover:shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2 relative shadow-lg"
            onclick="confirmAppointment()"
            disabled
          >
            <!-- Send Icon with animation -->
            <svg id="send-icon" class="w-5 h-5 transition-all duration-300 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
            </svg>

            <!-- Loading Icon -->
            <svg id="loading-icon" class="w-5 h-5 animate-spin hidden text-white" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>

            <!-- Success Checkmark Icon -->
            <svg id="success-icon" class="w-5 h-5 hidden text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
            </svg>

            <!-- Error Icon -->
            <svg id="error-icon" class="w-5 h-5 hidden text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>

            <!-- Button Text -->
            <span id="button-text" class="text-base font-semibold tracking-wide text-white" data-translate="summary.confirm_button">Termin best√§tigen</span>

            <!-- Shimmer effect overlay -->
            <div id="button-shimmer" class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 transform -skew-x-12 transition-all duration-1000"></div>
          </button>

          <!-- Status Messages -->
          <div id="status-message" class="mt-4 p-4 rounded-lg hidden transition-all duration-500 transform">
            <div class="flex items-center gap-3">
              <svg class="status-icon w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <p class="status-title font-bold text-base mb-1"></p>
                <p class="status-description text-sm"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer-brown text-white py-8">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-6 items-center">
        <!-- Logo & Practice Name -->
        <div class="flex items-center space-x-3">
          <img src="../assets/img/logo.svg" alt="Seitschenko-Dinh Logo" class="w-12 h-12 flex-shrink-0">
          <div class="flex flex-col">
            <h3 class="text-base font-bold uppercase tracking-wide leading-tight" data-translate="footer.practice_name1">ZAHNARZTPRAXEN</h3>
            <h3 class="text-base font-bold uppercase tracking-wide leading-tight" data-translate="footer.practice_name2">SEITSCHENKO-DINH</h3>
          </div>
        </div>

        <!-- Location 1: Schwarzbach -->
        <div class="flex items-center space-x-3">
          <div class="flex-shrink-0">
            <div class="w-10 h-10 rounded-full border-2 border-white flex items-center justify-center">
              <span class="text-lg font-bold">1</span>
            </div>
          </div>
          <div class="flex flex-col leading-tight">
            <p class="text-sm" data-translate="footer.location1.line1">Schwarzbach 2 | 42277 Wuppertal</p>
            <p class="text-sm" data-translate="footer.location1.line2">Tel.: 0202 660828</p>
          </div>
        </div>

        <!-- Location 2: Wall -->
        <div class="flex items-center space-x-3">
          <div class="flex-shrink-0">
            <div class="w-10 h-10 rounded-full border-2 border-white flex items-center justify-center">
              <span class="text-lg font-bold">2</span>
            </div>
          </div>
          <div class="flex flex-col leading-tight">
            <p class="text-sm" data-translate="footer.location2.line1">Loher Str. 40 | 42283 Wuppertal</p>
            <p class="text-sm" data-translate="footer.location2.line2">Tel.: 0202 451642</p>
          </div>
        </div>
      </div>

      <!-- Copyright -->
      <div class="mt-6 pt-4 text-center border-t border-white border-opacity-20">
        <p class="text-xs" data-translate="footer.copyright">
          ¬© 2024 Datenschutzerkl√§rung
        </p>
      </div>
    </div>
  </footer>

  <script src="../js/service-translations.js"></script>
  <script src="../js/chatbot.js"></script>
  <script>
    // Appointment booking state
    let selectedSymptom = null;
    // Initialize default language if not set (only on first visit)
    if (!localStorage.getItem('selectedLanguage')) {
      localStorage.setItem('selectedLanguage', 'de');
    }

    let selectedDoctor = null;
    let selectedDoctorEmail = null;  // Store doctor's email from Calendar sheet
    let selectedDoctorPhone = null;  // Store doctor's phone from Calendar sheet
    let selectedTime = null;
    let selectedDate = null;
    let customDescription = '';
    let currentWeekOffset = 0; // Week offset from current week
    let bookedAppointments = []; // Store booked appointments from Google Sheets

    // Helper function to get translated text
    function getTranslation(key) {
      const lang = localStorage.getItem('selectedLanguage') || 'de';
      const translations = serviceTranslations[lang];
      if (!translations) return '';

      // If key doesn't start with 'appointment.', add it
      const fullKey = key.startsWith('appointment.') ? key : 'appointment.' + key;

      const keys = fullKey.split('.');
      let value = translations;
      for (const k of keys) {
        if (value && value[k] !== undefined) {
          value = value[k];
        } else {
          return '';
        }
      }
      return value;
    }

    // Update patient form translations when language changes
    function updatePatientFormTranslations() {
      // Update all elements with data-translate attribute
      document.querySelectorAll('[data-translate]').forEach(el => {
        const key = el.getAttribute('data-translate');
        const translation = getTranslation(key);
        if (translation) {
          el.textContent = translation;
        }
      });

      // Update all input placeholders with data-translate-placeholder attribute
      document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
        const key = el.getAttribute('data-translate-placeholder');
        const translation = getTranslation(key);
        if (translation) {
          el.placeholder = translation;
        }
      });

      // Update reminder time dropdown options
      const reminderTimeSelect = document.getElementById('reminder-time');
      if (reminderTimeSelect) {
        const currentValue = reminderTimeSelect.value;
        reminderTimeSelect.innerHTML = `
          <option value="0.5">${getTranslation('summary.reminder_time_30min')}</option>
          <option value="1">${getTranslation('summary.reminder_time_1h')}</option>
          <option value="2">${getTranslation('summary.reminder_time_2h')}</option>
          <option value="3">${getTranslation('summary.reminder_time_3h')}</option>
          <option value="6">${getTranslation('summary.reminder_time_6h')}</option>
          <option value="12">${getTranslation('summary.reminder_time_12h')}</option>
          <option value="24">${getTranslation('summary.reminder_time_1d')}</option>
        `;
        reminderTimeSelect.value = currentValue || '2';
      }
    }

    // Calendar generation functions
    const DAYS_TRANSLATIONS = {
      de: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],
      en: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
      vi: ['Ch·ªß nh·∫≠t', 'Th·ª© hai', 'Th·ª© ba', 'Th·ª© t∆∞', 'Th·ª© nƒÉm', 'Th·ª© s√°u', 'Th·ª© b·∫£y'],
      ru: ['–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞'],
      ar: ['ÿßŸÑÿ£ÿ≠ÿØ', 'ÿßŸÑÿßÿ´ŸÜŸäŸÜ', 'ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°', 'ÿßŸÑÿ£ÿ±ÿ®ÿπÿßÿ°', 'ÿßŸÑÿÆŸÖŸäÿ≥', 'ÿßŸÑÿ¨ŸÖÿπÿ©', 'ÿßŸÑÿ≥ÿ®ÿ™']
    };

    const WORK_START_HOUR = 8;  // 8:00
    const WORK_END_HOUR = 17;   // 17:00
    const SLOT_INTERVAL = 90;   // 90 minutes (1 hour 30 minutes)

    // Get day name in current language
    function getDayName(dayIndex) {
      const lang = localStorage.getItem('selectedLanguage') || 'de';
      const dayName = DAYS_TRANSLATIONS[lang] ? DAYS_TRANSLATIONS[lang][dayIndex] : DAYS_TRANSLATIONS['de'][dayIndex];
      return dayName;
    }

    // Generate time slots for working hours
    function generateTimeSlots() {
      const slots = [];
      let currentMinutes = WORK_START_HOUR * 60; // Start at 8:00 (480 minutes)
      const endMinutes = WORK_END_HOUR * 60;     // End at 17:00 (1020 minutes)

      while (currentMinutes <= endMinutes) {
        const hours = Math.floor(currentMinutes / 60);
        const minutes = currentMinutes % 60;
        const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        slots.push(timeString);
        currentMinutes += SLOT_INTERVAL;
      }

      return slots;
    }

    // Format date as DD.MM
    function formatDate(date) {
      const day = date.getDate().toString().padStart(2, '0');
      const month = (date.getMonth() + 1).toString().padStart(2, '0');
      return `${day}.${month}`;
    }

    // Format date as DD.MM.YYYY (for Google Sheets API)
    function formatDateFull(date) {
      const day = date.getDate().toString().padStart(2, '0');
      const month = (date.getMonth() + 1).toString().padStart(2, '0');
      const year = date.getFullYear();
      return `${day}.${month}.${year}`;
    }

    // Fetch available time slots from Google Sheets Calendar
    async function fetchTimeSlotsFromCalendar(dateStr) {
      try {
        const url = `${GOOGLE_SHEET_URL}?action=getTimeSlots&date=${encodeURIComponent(dateStr)}`;
        const response = await fetch(url);

        if (!response.ok) {
          console.error('Failed to fetch time slots:', response.statusText);
          return null;
        }

        const data = await response.json();

        if (data.status === 'success') {
          // NEW API FORMAT: Returns object grouped by dentist
          // { "Seitschenko-Dinh": [{time: "08:00", status, available}, ...], "Kukadiya": [...], ... }
          // Also returns contacts: { "Seitschenko-Dinh": {email: "...", phone: "..."}, ... }

          // Store contacts globally for later use when booking
          if (data.contacts) {
            window.dentistContacts = data.contacts;
          }

          return data.slots;
        } else if (data.status === 'not_found') {
          console.warn(`Date ${dateStr} not found in Calendar sheet`);
          return null;
        } else {
          console.error('Error fetching time slots:', data.message);
          return null;
        }
      } catch (error) {
        console.error('Error fetching time slots from Calendar:', error);
        return null;
      }
    }

    // Get day label (Today, Tomorrow, or date)
    function getDayLabel(date) {
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      const tomorrow = new Date(today);
      tomorrow.setDate(tomorrow.getDate() + 1);

      const compareDate = new Date(date);
      compareDate.setHours(0, 0, 0, 0);

      const lang = localStorage.getItem('selectedLanguage') || 'de';

      if (compareDate.getTime() === today.getTime()) {
        const todayLabels = {
          de: 'Heute',
          en: 'Today',
          vi: 'H√¥m nay',
          ru: '–°–µ–≥–æ–¥–Ω—è',
          ar: 'ÿßŸÑŸäŸàŸÖ'
        };
        return todayLabels[lang] || 'Today';
      } else if (compareDate.getTime() === tomorrow.getTime()) {
        const tomorrowLabels = {
          de: 'Morgen',
          en: 'Tomorrow',
          vi: 'Ng√†y mai',
          ru: '–ó–∞–≤—Ç—Ä–∞',
          ar: 'ÿ∫ÿØÿßŸã'
        };
        return tomorrowLabels[lang] || 'Tomorrow';
      } else {
        return formatDate(date);
      }
    }

    // Generate calendar for the current week (NOW ASYNC - fetches from Google Sheets)
    async function generateCalendar() {
      const container = document.getElementById('time-slots-container');
      if (!container) return;

      container.innerHTML = '<div class="text-center py-8 text-gray-600">ƒêang t·∫£i l·ªãch...</div>'; // Loading state

      const today = new Date();
      today.setHours(0, 0, 0, 0);

      // Calculate the start date based on week offset
      // Start from TODAY (not Monday of the week)
      const startDate = new Date(today);
      startDate.setDate(startDate.getDate() + (currentWeekOffset * 7));

      console.log('üìÖ generateCalendar - Today:', today.toDateString());
      console.log('üìÖ generateCalendar - Start Date:', startDate.toDateString());
      console.log('üìÖ generateCalendar - Week Offset:', currentWeekOffset);

      // Update week display first
      updateWeekDisplay(startDate);

      // Clear loading message
      container.innerHTML = '';

      // Generate dates - show all 7 days (including weekends)
      const daysToShow = 7;

      for (let i = 0; i < daysToShow; i++) {
        const currentDate = new Date(startDate);
        currentDate.setDate(currentDate.getDate() + i);

        const dayOfWeek = currentDate.getDay(); // 0=Sunday, 6=Saturday
        const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);

        const dayName = getDayName(dayOfWeek);
        const dateStr = formatDate(currentDate);
        const dateStrFull = formatDateFull(currentDate); // DD.MM.YYYY for API
        const dayLabel = getDayLabel(currentDate);

        // Create day section
        const daySection = document.createElement('div');
        daySection.className = 'mb-6';

        // Day header - different styling for weekends
        const dayHeader = document.createElement('div');
        dayHeader.className = 'flex items-center justify-between mb-3';

        if (isWeekend) {
          // Weekend: red/pink styling
          dayHeader.innerHTML = `
            <div class="bg-red-50 px-4 py-2 rounded-lg border-2 border-red-200 w-full">
              <p class="font-semibold text-red-800">${dayLabel}</p>
              <p class="text-sm text-red-600">${dayName}, ${dateStr} - <span class="font-bold">Geschlossen / Closed</span></p>
            </div>
          `;
        } else {
          // Weekday: normal styling
          dayHeader.innerHTML = `
            <div>
              <p class="font-semibold text-gray-800">${dayLabel}</p>
              <p class="text-sm text-gray-600">${dayName}, ${dateStr}</p>
            </div>
          `;
        }
        daySection.appendChild(dayHeader);

        // Time slots grid
        const slotsGrid = document.createElement('div');
        slotsGrid.className = 'grid grid-cols-3 md:grid-cols-6 gap-3';

        // Fetch time slots from Google Sheets Calendar
        const calendarSlots = await fetchTimeSlotsFromCalendar(dateStrFull);

        if (calendarSlots) {
          // NEW API FORMAT: calendarSlots is now grouped by dentist
          // { "Seitschenko-Dinh": [{time, status, available}, ...], "Kukadiya": [...], ... }

          console.log('üìÖ Calendar API Response:', calendarSlots);
          console.log('üë®‚Äç‚öïÔ∏è Selected Doctor:', selectedDoctor);

          // If a doctor is selected, find matching dentist (case-insensitive)
          let doctorsToShow = Object.keys(calendarSlots);

          if (selectedDoctor) {
            const selectedLower = selectedDoctor.toLowerCase();
            doctorsToShow = doctorsToShow.filter(dentist =>
              dentist.toLowerCase() === selectedLower
            );
          }

          console.log('üîç Doctors to show:', doctorsToShow);

          // Collect all time slots from selected doctors
          const allSlots = [];
          const seenTimes = new Set(); // Track unique time slots

          doctorsToShow.forEach(dentistName => {
            const dentistSlots = calendarSlots[dentistName];
            if (dentistSlots && Array.isArray(dentistSlots)) {
              dentistSlots.forEach(slotData => {
                const timeKey = slotData.time;

                // If no doctor selected, only show each time slot once
                if (!selectedDoctor && seenTimes.has(timeKey)) {
                  return; // Skip duplicate time slots
                }

                seenTimes.add(timeKey);
                allSlots.push({
                  ...slotData,
                  dentist: dentistName
                });
              });
            }
          });

          // Sort by time
          allSlots.sort((a, b) => {
            const timeA = a.time.replace(':', '');
            const timeB = b.time.replace(':', '');
            return parseInt(timeA) - parseInt(timeB);
          });

          // Count visible slots (non-hidden)
          let visibleSlotCount = 0;

          // Render slots
          allSlots.forEach(slotData => {
            const slot = document.createElement('div');
            const time = slotData.time;
            const status = slotData.status; // 'available', 'blocked', 'booked', 'hidden'
            const isAvailable = slotData.available; // boolean
            const dentist = slotData.dentist; // dentist name

            // Skip hidden slots (weekends)
            if (status === 'hidden') {
              return;
            }

            visibleSlotCount++;

            if (status === 'booked') {
              // Booked slot - show as disabled
              const bookedLabel = getTranslation('appointment.time_slots.booked') || 'Gebucht';
              slot.className = 'time-slot booked bg-yellow-100 text-yellow-800 rounded-lg px-4 py-3 text-center font-medium cursor-not-allowed relative border-2 border-yellow-300';
              slot.innerHTML = `
                <span class="line-through text-lg">${time}</span>
                <span class="block text-xs mt-1 font-semibold">‚úì ${bookedLabel}</span>
              `;
              slot.style.pointerEvents = 'none';
            } else if (status === 'blocked') {
              // Blocked slot - show as disabled
              const blockedLabel = getTranslation('appointment.time_slots.blocked') || 'Gesperrt';
              slot.className = 'time-slot blocked bg-red-100 text-red-800 rounded-lg px-4 py-3 text-center font-medium cursor-not-allowed relative border-2 border-red-300';
              slot.innerHTML = `
                <span class="line-through text-lg">${time}</span>
                <span class="block text-xs mt-1 font-semibold">‚úó ${blockedLabel}</span>
              `;
              slot.style.pointerEvents = 'none';
            } else {
              // Available slot - clickable
              slot.className = 'time-slot bg-teal-600 text-white rounded-lg px-4 py-3 text-center font-medium cursor-pointer hover:bg-teal-700 transition-colors';
              slot.textContent = time;
              slot.onclick = function() { selectTimeSlot(this, dateStr, time); };
            }

            slotsGrid.appendChild(slot);
          });

          // If no visible slots and NOT a weekend, show "no slots available" message
          if (visibleSlotCount === 0 && !isWeekend) {
            const noSlotsMsg = document.createElement('div');
            noSlotsMsg.className = 'col-span-6 text-center text-gray-500 py-4';
            noSlotsMsg.textContent = 'Keine Termine verf√ºgbar / No slots available';
            slotsGrid.appendChild(noSlotsMsg);
          }
        } else if (!isWeekend) {
          // Fallback: If date not found in Calendar and NOT weekend, show message
          const noSlotsMsg = document.createElement('div');
          noSlotsMsg.className = 'col-span-6 text-center text-gray-500 py-4';
          noSlotsMsg.textContent = 'Keine Termine verf√ºgbar / No slots available';
          slotsGrid.appendChild(noSlotsMsg);
        }

        // Only append slotsGrid if it has children (weekdays) or if it's not a weekend
        // For weekends, we don't show the empty grid
        if (slotsGrid.children.length > 0 || !isWeekend) {
          daySection.appendChild(slotsGrid);
        }

        container.appendChild(daySection);
      }
    }

    // Update the week range display
    function updateWeekDisplay(startDate) {
      const weekElement = document.getElementById('current-week');
      if (!weekElement) return;

      const endDate = new Date(startDate);
      endDate.setDate(endDate.getDate() + 6);

      const startStr = formatDate(startDate);
      const endStr = formatDate(endDate);
      const year = startDate.getFullYear();

      weekElement.textContent = `${startStr} - ${endStr}.${year}`;
    }

    // Initialize week display with loading text
    function initializeWeekDisplay() {
      const weekElement = document.getElementById('current-week');
      if (weekElement) {
        const loadingText = getTranslation('calendar.loading') || 'Laden...';
        weekElement.textContent = loadingText;
      }
    }

    // Initialize calendar on page load
    document.addEventListener('DOMContentLoaded', function() {
      initializeWeekDisplay();
      // Don't generate calendar until doctor is selected
      // generateCalendar();

      // Update patient form translations on page load
      updatePatientFormTranslations();

      // Add event listener for custom description textarea
      const descriptionTextarea = document.getElementById('custom-description');
      if (descriptionTextarea) {
        descriptionTextarea.addEventListener('input', function(e) {
          customDescription = e.target.value.trim();
          updateSummary();
        });
      }

      // Don't fetch appointments on initial load (no doctor selected yet)
      console.log('Calendar initialized. Select a doctor to load their appointments.');
    });

    // Listen for language changes to update calendar text
    window.addEventListener('languageChanged', function() {
      initializeWeekDisplay();
      // Only regenerate calendar if doctor is already selected
      if (selectedDoctor) {
        generateCalendar();
      }
    });

    // Select symptom with 3D dimming effect - with toggle functionality
    function selectSymptom(element, symptomType) {
      const allCards = document.querySelectorAll('.symptom-card');
      const isAlreadySelected = element.classList.contains('selected');

      // If clicking on already selected card, deselect it
      if (isAlreadySelected) {
        // Remove all selected and dimmed classes
        allCards.forEach(card => {
          card.classList.remove('selected', 'dimmed');
        });
        selectedSymptom = null;
        updateSummary();
        return;
      }

      // Remove selected and dimmed from all cards
      allCards.forEach(card => {
        card.classList.remove('selected', 'dimmed');
      });

      // Add selected to clicked card
      element.classList.add('selected');

      // Add dimmed to all other cards
      allCards.forEach(card => {
        if (card !== element) {
          card.classList.add('dimmed');
        }
      });

      selectedSymptom = symptomType;
      updateSummary();
    }

    // Toggle doctor dropdown menu
    const doctorSelectorBtn = document.getElementById('doctor-selector-btn');
    if (doctorSelectorBtn) {
      doctorSelectorBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        const menu = document.getElementById('doctor-dropdown-menu');
        if (menu) menu.classList.toggle('hidden');
      });
    }

    // Fetch booked appointments for a doctor
    async function fetchBookedAppointments(doctorId) {
      // Validate doctorId
      if (!doctorId || doctorId.trim() === '') {
        console.warn('No doctor selected, skipping appointment fetch');
        bookedAppointments = [];
        return;
      }

      try {
        // Calculate date range (current week + 2 weeks ahead)
        const today = new Date();
        const fromDate = new Date(today);
        fromDate.setDate(fromDate.getDate() + (currentWeekOffset * 7));

        const toDate = new Date(fromDate);
        toDate.setDate(toDate.getDate() + 21); // 3 weeks

        // Format dates as DD.MM.YYYY
        const formatDateForAPI = (date) => {
          const day = date.getDate().toString().padStart(2, '0');
          const month = (date.getMonth() + 1).toString().padStart(2, '0');
          const year = date.getFullYear();
          return `${day}.${month}.${year}`;
        };

        const fromDateStr = formatDateForAPI(fromDate);
        const toDateStr = formatDateForAPI(toDate);

        // Build query URL
        const url = `${GOOGLE_SHEET_URL}?doctor=${encodeURIComponent(doctorId)}&fromDate=${fromDateStr}&toDate=${toDateStr}`;

        console.log(`Fetching appointments for ${doctorId}...`, url);

        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Accept': 'application/json'
          }
        });

        const data = await response.json();

        if (data.status === 'success' && data.appointments) {
          bookedAppointments = data.appointments;
          console.log(`‚úì Loaded ${bookedAppointments.length} appointments for ${doctorId}`);
        } else {
          bookedAppointments = [];
          console.warn('No appointments found or failed to fetch:', data.message || 'Unknown error');
        }

      } catch (error) {
        console.error('Error fetching appointments:', error);
        bookedAppointments = [];
      }

      // Regenerate calendar to show booked slots
      generateCalendar();
    }

    // Check if a time slot is booked
    function isSlotBooked(date, time) {
      const year = date.getFullYear();
      const dateStrFull = formatDate(date) + '.' + year; // DD.MM.YYYY
      const dateStrShort = formatDate(date); // DD.MM (without year)

      // Debug: log first check to see data structure
      if (bookedAppointments.length > 0 && time === '08:00') {
        console.log(`üîç Checking slot: date=${dateStrShort} (${dateStrFull}), time=${time}`);
        console.log('üìã Sample appointment:', JSON.stringify(bookedAppointments[0]));
        console.log(`üìä Total appointments to check: ${bookedAppointments.length}`);
      }

      const isBooked = bookedAppointments.some(apt => {
        // Match both formats: "DD.MM.YYYY" or "DD.MM"
        const aptDate = apt.date ? apt.date.trim() : '';
        const aptTime = apt.time ? apt.time.trim() : '';

        const dateMatch = (aptDate === dateStrFull || aptDate === dateStrShort);
        const timeMatch = (aptTime === time);

        // Debug log for 08:00 slot on 21.11
        if (time === '08:00' && aptDate.includes('21.11')) {
          console.log(`  üî∏ Compare date: "${aptDate}" === "${dateStrShort}" or "${dateStrFull}"? ‚Üí ${dateMatch}`);
          console.log(`  üî∏ Compare time: "${aptTime}" === "${time}"? ‚Üí ${timeMatch}`);
          console.log(`  üî∏ Result: dateMatch=${dateMatch}, timeMatch=${timeMatch}`);
        }

        // Debug log (only for successful matches)
        if (dateMatch && timeMatch) {
          console.log(`‚úÖ MATCHED! Slot booked: ${dateStrShort} at ${time}`);
        }

        return dateMatch && timeMatch;
      });

      return isBooked;
    }

    // Select doctor from dropdown
    function selectDoctorFromDropdown(doctorId, name, location, avatar) {
      // Update selected doctor
      selectedDoctor = doctorId;

      // Get doctor's contact info from stored contacts (if available)
      if (window.dentistContacts) {
        // Find matching dentist in contacts (case-insensitive match)
        const dentistKey = Object.keys(window.dentistContacts).find(key =>
          key.toLowerCase() === doctorId.toLowerCase()
        );

        if (dentistKey && window.dentistContacts[dentistKey]) {
          selectedDoctorEmail = window.dentistContacts[dentistKey].email || null;
          selectedDoctorPhone = window.dentistContacts[dentistKey].phone || null;
          console.log(`‚úÖ Loaded contacts for ${doctorId}: email=${selectedDoctorEmail}, phone=${selectedDoctorPhone}`);
        } else {
          console.warn(`‚ö†Ô∏è No contact info found for ${doctorId}`);
          selectedDoctorEmail = null;
          selectedDoctorPhone = null;
        }
      } else {
        console.warn('‚ö†Ô∏è Dentist contacts not yet loaded from API');
        selectedDoctorEmail = null;
        selectedDoctorPhone = null;
      }

      // Reset week offset to show current week when doctor is selected
      currentWeekOffset = 0;

      // Update button display
      const avatarEl = document.getElementById('selected-doctor-avatar');
      const nameEl = document.getElementById('selected-doctor-name');
      const locationEl = document.getElementById('selected-doctor-location');
      const menuEl = document.getElementById('doctor-dropdown-menu');

      if (avatarEl) avatarEl.src = avatar;
      if (nameEl) {
        nameEl.textContent = name;
        nameEl.removeAttribute('data-translate');
      }
      if (locationEl) locationEl.textContent = location;

      // Hide dropdown
      if (menuEl) menuEl.classList.add('hidden');

      // Show calendar section
      const calendarSection = document.getElementById('appointment-calendar');
      if (calendarSection) {
        calendarSection.classList.remove('hidden');
      }

      // Load dentist contacts immediately by fetching slots for current week start date
      // This ensures contacts are available before user books
      const today = new Date();
      const weekStart = new Date(today);
      weekStart.setDate(today.getDate() - today.getDay() + (today.getDay() === 0 ? -6 : 1)); // Monday of current week
      const dateStr = formatDateFull(weekStart);

      fetchTimeSlotsFromCalendar(dateStr).then(() => {
        console.log('‚úÖ Dentist contacts loaded for', doctorId);
      }).catch(err => {
        console.warn('‚ö†Ô∏è Failed to load dentist contacts:', err);
      });

      // Fetch booked appointments for this doctor
      fetchBookedAppointments(doctorId);

      // Update summary
      updateSummary();

      // Scroll to calendar
      setTimeout(() => {
        if (calendarSection) {
          calendarSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }, 300);
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', function(e) {
      const selector = document.querySelector('.doctor-selector');
      const menu = document.getElementById('doctor-dropdown-menu');
      if (selector && menu && !selector.contains(e.target)) {
        menu.classList.add('hidden');
      }
    });

    // Select time slot - with toggle functionality and dimming effect
    function selectTimeSlot(element, date, time) {
      const allSlots = document.querySelectorAll('.time-slot');
      const isAlreadySelected = element.classList.contains('selected');

      // If clicking on already selected slot, deselect it
      if (isAlreadySelected) {
        // Remove all selected and dimmed classes
        allSlots.forEach(slot => {
          slot.classList.remove('selected', 'dimmed');
        });
        selectedDate = null;
        selectedTime = null;
        updateSummary();
        return;
      }

      // Remove selected and dimmed from all slots
      allSlots.forEach(slot => {
        slot.classList.remove('selected', 'dimmed');
      });

      // Add selected to clicked slot
      element.classList.add('selected');

      // Add dimmed to all other slots
      allSlots.forEach(slot => {
        if (slot !== element) {
          slot.classList.add('dimmed');
        }
      });

      selectedDate = date;
      selectedTime = time;
      updateSummary();
    }

    // Update booking summary
    function updateSummary() {
      const symptomText = {
        'pain': getTranslation('symptoms.pain.title'),
        'checkup': getTranslation('symptoms.checkup.title'),
        'consultation': getTranslation('symptoms.consultation.title'),
        'cleaning': getTranslation('symptoms.cleaning.title')
      };

      const doctorText = {
        'kukadiya': getTranslation('doctors.kukadiya.name'),
        'ikikardes': getTranslation('doctors.ikikardes.name'),
        'taifour': getTranslation('doctors.taifour.name'),
        'nikolaou': getTranslation('doctors.nikolaou.name')
      };

      const noneSelected = getTranslation('summary.none_selected') || '-';

      const symptomTextEl = document.getElementById('selected-symptom-text');
      const doctorTextEl = document.getElementById('selected-doctor-text');
      const timeTextEl = document.getElementById('selected-time-text');
      const customDescBoxEl = document.getElementById('custom-description-text');
      const customDescContentEl = document.getElementById('custom-description-content');

      if (symptomTextEl) symptomTextEl.textContent = selectedSymptom ? symptomText[selectedSymptom] : noneSelected;
      if (doctorTextEl) doctorTextEl.textContent = selectedDoctor ? doctorText[selectedDoctor] : noneSelected;
      if (timeTextEl) timeTextEl.textContent = (selectedDate && selectedTime) ? `${selectedDate}.2024 um ${selectedTime} Uhr` : noneSelected;

      // Update custom description display
      if (customDescBoxEl && customDescContentEl) {
        if (customDescription) {
          customDescContentEl.textContent = '"' + customDescription + '"';
          customDescBoxEl.style.display = 'block';
        } else {
          customDescBoxEl.style.display = 'none';
        }
      }

      // Enable/disable confirm button
      const confirmButton = document.getElementById('confirm-button');
      if (confirmButton) {
        if (selectedSymptom && selectedDoctor && selectedDate && selectedTime) {
          confirmButton.disabled = false;
        } else {
          confirmButton.disabled = true;
        }
      }
    }

    // Google Sheets Web App URL - REPLACE THIS WITH YOUR DEPLOYED WEB APP URL
    const GOOGLE_SHEET_URL = 'https://script.google.com/macros/s/AKfycbwybE6506ySBANvTz_0Xus7m0fSR0FH50eCY7USNguLjuNHDuhQhiNYvR0G0r5XCUQYqA/exec';

    // Show status message with animation
    function showStatusMessage(type, title, description) {
      const statusBox = document.getElementById('status-message');
      const statusTitle = statusBox.querySelector('.status-title');
      const statusDesc = statusBox.querySelector('.status-description');
      const statusIcon = statusBox.querySelector('.status-icon path');

      // Set content
      statusTitle.textContent = title;
      statusDesc.textContent = description;

      // Remove previous classes
      statusBox.classList.remove('hidden', 'bg-blue-50', 'bg-green-50', 'bg-red-50', 'border-blue-200', 'border-green-200', 'border-red-200', 'scale-95', 'opacity-0');
      statusBox.classList.remove('text-blue-800', 'text-green-800', 'text-red-800');

      // Set colors based on type
      if (type === 'sending') {
        statusBox.className = 'mt-4 p-4 rounded-lg bg-blue-50 border-2 border-blue-200 text-blue-800 transition-all duration-500 transform scale-100 opacity-100';
        statusIcon.setAttribute('d', 'M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z');
      } else if (type === 'success') {
        statusBox.className = 'mt-4 p-4 rounded-lg bg-green-50 border-2 border-green-200 text-green-800 transition-all duration-500 transform scale-100 opacity-100';
        statusIcon.setAttribute('d', 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z');
      } else if (type === 'error') {
        statusBox.className = 'mt-4 p-4 rounded-lg bg-red-50 border-2 border-red-200 text-red-800 transition-all duration-500 transform scale-100 opacity-100';
        statusIcon.setAttribute('d', 'M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z');
      }

      // Animate in
      setTimeout(() => {
        statusBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }

    // Hide status message
    function hideStatusMessage() {
      const statusBox = document.getElementById('status-message');
      statusBox.classList.add('opacity-0', 'scale-95');
      setTimeout(() => {
        statusBox.classList.add('hidden');
      }, 500);
    }

    // Confirm appointment and send to Google Sheets
    async function confirmAppointment() {
      // Validate all required fields
      if (!selectedSymptom || !selectedDoctor || !selectedDate || !selectedTime) {
        const incompleteMsg = getTranslation('alerts.incomplete');
        showStatusMessage('error', '‚ö†Ô∏è ' + (getTranslation('summary.error_title') || 'Fehler'), incompleteMsg);
        return;
      }

      // Get patient information
      const patientFirstname = document.getElementById('patient-firstname').value.trim();
      const patientLastname = document.getElementById('patient-lastname').value.trim();
      const patientBirthYear = document.getElementById('patient-birth-year').value.trim();
      const patientPhone = document.getElementById('patient-phone').value.trim();
      const patientEmail = document.getElementById('patient-email').value.trim();
      const reminderTime = document.getElementById('reminder-time').value;

      // Combine first and last name
      const patientName = patientFirstname + ' ' + patientLastname;

      // Validate patient information fields
      if (!patientFirstname || !patientLastname || !patientBirthYear || !patientPhone || !patientEmail) {
        const incompleteMsg = getTranslation('alerts.incomplete');
        showStatusMessage('error', '‚ö†Ô∏è ' + (getTranslation('summary.error_title') || 'Fehler'), incompleteMsg);
        return;
      }

      // Validate email format
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(patientEmail)) {
        showStatusMessage('error', '‚ö†Ô∏è ' + (getTranslation('summary.error_title') || 'Fehler'), 'Bitte geben Sie eine g√ºltige E-Mail-Adresse ein.');
        return;
      }

      // Validate birth year range
      const birthYear = parseInt(patientBirthYear);
      if (isNaN(birthYear) || birthYear < 1900 || birthYear > 2025) {
        showStatusMessage('error', '‚ö†Ô∏è ' + (getTranslation('summary.error_title') || 'Fehler'), 'Bitte geben Sie ein g√ºltiges Geburtsjahr ein (1900-2025).');
        return;
      }

      // Get button and icon elements
      const confirmButton = document.getElementById('confirm-button');
      const buttonText = document.getElementById('button-text');
      const sendIcon = document.getElementById('send-icon');
      const loadingIcon = document.getElementById('loading-icon');
      const successIcon = document.getElementById('success-icon');
      const errorIcon = document.getElementById('error-icon');
      const shimmer = document.getElementById('button-shimmer');

      // Hide status message from previous attempts
      hideStatusMessage();

      // Trigger send icon fly animation
      sendIcon.classList.add('icon-fly');

      // Wait for animation, then switch to loading
      setTimeout(() => {
        sendIcon.classList.add('hidden');
        sendIcon.classList.remove('icon-fly');
        loadingIcon.classList.remove('hidden');
      }, 300);

      // Change button state to sending
      confirmButton.disabled = true;
      confirmButton.classList.add('sending');
      buttonText.textContent = getTranslation('summary.sending') || 'Wird gesendet...';

      // Show sending status message
      const sendingTitle = getTranslation('summary.sending') || 'Wird gesendet...';
      const sendingDesc = getTranslation('alerts.sending_desc') || 'Ihre Buchungsanfrage wird √ºbermittelt...';
      showStatusMessage('sending', 'üì§ ' + sendingTitle, sendingDesc);

      // Get custom description
      const customDescElement = document.getElementById('custom-description');
      const customDescription = customDescElement ? customDescElement.value.trim() : '';

      // Prepare data to send
      const appointmentData = {
        symptom: selectedSymptom,
        doctor: selectedDoctor,
        doctorEmail: selectedDoctorEmail,     // Add doctor's email
        doctorPhone: selectedDoctorPhone,     // Add doctor's phone
        date: selectedDate,
        time: selectedTime,
        description: customDescription,
        language: currentLanguage,
        patientName: patientName,
        patientFirstname: patientFirstname,
        patientLastname: patientLastname,
        patientBirthYear: patientBirthYear,
        patientPhone: patientPhone,
        patientEmail: patientEmail,
        reminderTime: reminderTime
      };

      try {
        // Send data to Google Sheets
        const response = await fetch(GOOGLE_SHEET_URL, {
          method: 'POST',
          mode: 'no-cors', // Required for Google Apps Script
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(appointmentData)
        });

        // Note: With no-cors mode, we can't read the response
        // We assume success if no error is thrown

        // Wait a moment to simulate sending
        await new Promise(resolve => setTimeout(resolve, 1500));

        // Switch to success state
        confirmButton.classList.remove('sending');
        confirmButton.classList.add('success');
        loadingIcon.classList.add('hidden');
        successIcon.classList.remove('hidden');
        successIcon.classList.add('icon-success');
        buttonText.textContent = getTranslation('summary.success_title') || 'Erfolgreich gesendet!';

        // Show success status message
        const successTitle = getTranslation('summary.success_title') || 'Erfolgreich gesendet!';
        const successDesc = getTranslation('alerts.success') || 'Vielen Dank! Ihr Termin wurde erfolgreich an uns gesendet.';
        showStatusMessage('success', '‚úÖ ' + successTitle, successDesc);

        // Trigger shimmer effect
        shimmer.style.opacity = '0.3';
        shimmer.style.transform = 'translateX(0)';
        setTimeout(() => {
          shimmer.style.transform = 'translateX(200%)';
        }, 100);
        setTimeout(() => {
          shimmer.style.opacity = '0';
          shimmer.style.transform = 'translateX(-200%)';
        }, 1100);

        // Redirect to home page after delay
        setTimeout(() => {
          window.location.href = '../index.html';
        }, 3000);

      } catch (error) {
        console.error('Error sending appointment data:', error);

        // Switch to error state
        confirmButton.classList.remove('sending');
        confirmButton.classList.add('error');
        loadingIcon.classList.add('hidden');
        errorIcon.classList.remove('hidden');
        buttonText.textContent = getTranslation('summary.error_title') || 'Fehler beim Senden';

        // Show error status message
        const errorTitle = getTranslation('summary.error_title') || 'Fehler beim Senden';
        const errorDesc = getTranslation('alerts.error') || 'Es gab einen Fehler beim Senden. Bitte versuchen Sie es erneut.';
        showStatusMessage('error', '‚ùå ' + errorTitle, errorDesc);

        // Re-enable button after a delay
        setTimeout(() => {
          confirmButton.disabled = false;
          confirmButton.classList.remove('error');
          errorIcon.classList.add('hidden');
          sendIcon.classList.remove('hidden');
          buttonText.textContent = getTranslation('summary.confirm_button') || 'Absenden';
        }, 3000);
      }
    }

    // Calendar navigation
    function previousWeek() {
      if (currentWeekOffset > 0) {
        currentWeekOffset--;
        generateCalendar();
      }
    }

    function nextWeek() {
      currentWeekOffset++;
      generateCalendar();
    }

    function loadMoreDates() {
      currentWeekOffset++;
      generateCalendar();
      // Scroll to calendar section
      const calendarSection = document.getElementById('appointment-calendar');
      if (calendarSection) {
        calendarSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    // Hook into service-translations.js changeLanguage to regenerate calendar
    // Wait for DOM to load, then override changeLanguage
    document.addEventListener('DOMContentLoaded', function() {
      // Store original changeLanguage from service-translations.js
      const originalChangeLanguage = window.changeLanguage;

      // Override to add calendar regeneration
      window.changeLanguage = function(lang) {
        // Call original function from service-translations.js
        if (originalChangeLanguage) {
          originalChangeLanguage(lang);
        }

        // Update patient form translations
        updatePatientFormTranslations();

        // Only regenerate calendar if doctor is already selected
        if (selectedDoctor) {
          setTimeout(function() {
            generateCalendar();
          }, 100);
        }
      };
    });

    // Mobile menu and language switcher are handled by service-translations.js
  </script>
</body>
</html>
